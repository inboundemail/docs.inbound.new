---
title: "Reply to Email"
api: "POST https://inbound.new/api/v2/emails/{id}/reply"
description: "Send a reply to a received email with proper threading"
---

<Note>
  This endpoint allows you to reply to emails received through Inbound,
  maintaining proper email threading with In-Reply-To and References headers.
</Note>

## Authentication

This endpoint requires authentication via:

- **API key auth**: Bearer token in Authorization header

## Path Parameters

<ParamField path="id" type="string" required>
  The unique identifier of the email or thread you want to reply to. 
  
  Can be either:
  - An **email ID** (e.g., `email_abc123`) - Replies to that specific email
  - A **thread ID** (e.g., `thread_xyz789`) - Replies to the latest message in the thread
  
  <Info>
  When providing a thread ID, the system automatically replies to the most recent email in that thread, ensuring proper conversation continuity.
  </Info>
</ParamField>

## Request Body

<ParamField body="from" type="string" required>
  The sender email address. 
  
  Must be in the format `"Name <email@domain.com>"` or  `"email@domain.com"`. 
  
  The domain must be verified in your account.
  
  <Warning>
  You cannot use `agent@inbnd.dev` for replies. This email is only available for sending new emails, not for replying to received emails.
  </Warning>
</ParamField>

<ParamField body="from_name" type="string" optional>
  Optional sender name for display. If provided, this will be used as the
  display name for the sender address.
</ParamField>

<ParamField body="to" type="string | string[]" optional>
  The recipient email address(es). If not provided, the reply will be sent to
  the original sender. Can be a single email string or an array of email
  strings.
</ParamField>

<ParamField body="subject" type="string" optional>
  The email subject. If not provided, "Re: " will be prepended to the original
  email's subject.
</ParamField>

<ParamField body="cc" type="string | string[]" optional>
  Carbon copy recipient(s). Can be a single email string or an array of email
  strings.
</ParamField>

<ParamField body="bcc" type="string | string[]" optional>
  Blind carbon copy recipient(s). Can be a single email string or an array of
  email strings.
</ParamField>

<ParamField body="reply_to" type="string | string[]" optional>
  Reply-to address(es). Can be a single email string or an array of email strings.

  <Danger>
  The `reply_to` method will be deprecated in a future version.
  </Danger>
</ParamField>

<ParamField body="replyTo" type="string | string[]" optional>
  Reply-to address(es). Can be a single email string or an array of email
  strings.
</ParamField>

<ParamField body="text" type="string" optional>
  The plain text version of the email body. Either `text` or `html` must be provided.

If you only provide `html` the `text` will be generated automatically from the HTML.

</ParamField>

<ParamField body="html" type="string" optional>
  The HTML version of the email body.
</ParamField>

<ParamField body="headers" type="object" optional>
  Custom email headers as key-value pairs. These will be added to the email in addition to the standard headers.
  
  ```typescript
  {
    "X-Priority": "1",                    // High priority
    "X-Support-Ticket": "TICKET-12345",  // Ticket tracking
    "X-Department": "Customer-Support",   // Department routing
    "Reply-To": "noreply@yourdomain.com", // Override reply-to
    "X-Auto-Reply": "true"                // Mark as automated
  }
  ```
  
  <Note>
  Headers are merged with threading headers (In-Reply-To, References) and standard email headers (Message-ID, Date, etc.). Custom headers take precedence over defaults but cannot override required threading headers.
  </Note>
</ParamField>

<ParamField body="attachments" type="array" optional>
  Array of file attachments to include with the email.
  
  <Expandable title="Attachment object properties">
    <ParamField body="content" type="string">
      Base64 encoded file content. Required if `path` is not provided.
    </ParamField>
    
    <ParamField body="path" type="string">
      URL to fetch the attachment from. Required if `content` is not provided. Only HTTP and HTTPS URLs are supported.
    </ParamField>
    
    <ParamField body="filename" type="string" required>
      Name of the file
    </ParamField>
    
    <ParamField body="content_type" type="string" optional>
      MIME type of the file (e.g., "application/pdf", "image/png"). Also accepts `contentType` (camelCase) for Resend compatibility.
    </ParamField>
    
    <ParamField body="content_id" type="string" optional>
      Content ID for embedding images in HTML email using `cid:` references (e.g., `<img src="cid:logo">`). Must be unique across all attachments.
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="include_original" type="boolean" optional default="true">
  Whether to include the original message as a quoted reply. When true, the
  original message will be appended to your reply with appropriate formatting.
  Also accepts `includeOriginal` (camelCase) for Resend compatibility.
</ParamField>

<ParamField body="replyAll" type="boolean" optional default="false">
  Whether to reply to all recipients (Reply All behavior). 
  
  When `true`:
  - Includes the original sender in the `to` field
  - Includes all original CC recipients (excluding yourself)
  - Does NOT include BCC recipients (as per email standards)
  
  When `false` (default):
  - Only replies to the original sender
  
  <Note>
  The current user's email address is automatically excluded from the recipient list to prevent self-replies.
  </Note>
</ParamField>

<ParamField body="tags" type="array" optional>
  Array of tags for email categorization and tracking (Resend-compatible).
  <Expandable title="Tag object properties">
    <ParamField body="name" type="string" required>
      Tag name for categorization
    </ParamField>

    <ParamField body="value" type="string" required>
      Tag value for the given name
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="simple" type="boolean" default="true">
  Whether to use simplified reply mode for faster processing. When `true`
  (default), uses a lightweight reply mode that's faster and has less overhead.
  Set to `false` to force full mode when you need advanced features or custom
  threading.
  <Note>
    Simple mode is automatically disabled when attachments are present.
  </Note>
</ParamField>

## Headers

<ParamField header="Authorization" type="string" required>
  Bearer token for API authentication.
</ParamField>

<ParamField header="Idempotency-Key" type="string">
  Add an idempotency key to prevent duplicate replies. * Should be **unique per
  API request** * Idempotency keys expire after **24 hours** * Have a maximum
  length of **256 characters**
</ParamField>

<ParamField header="API-Version" type="string">
  Specify a historical API version to maintain backward compatibility.
  
  Available versions:
  - `reply-10-01-25` - Legacy reply endpoint from January 1, 2025
  
  <Info>
  Omit this header to use the current API version with the latest features (recommended).
  </Info>
</ParamField>

## Response

<ResponseField name="id" type="string" required>
  Unique identifier for the sent reply email in Inbound's system
</ResponseField>

<ResponseField name="messageId" type="string" required>
  The Inbound message ID used for email threading (appears in Message-ID header)
</ResponseField>

<ResponseField name="awsMessageId" type="string" optional>
  AWS SES Message ID for tracking the email through AWS infrastructure. Only
  present when the email is successfully sent through AWS SES.
</ResponseField>

<ResponseField name="repliedToEmailId" type="string" required>
  The actual email ID that was replied to. This is always an email ID, even if you provided a thread ID in the request.
</ResponseField>

<ResponseField name="repliedToThreadId" type="string" optional>
  The thread ID associated with the email, if the reply is part of a conversation thread.
</ResponseField>

<ResponseField name="isThreadReply" type="boolean" required>
  Indicates whether the reply was made to a thread ID (`true`) or directly to an email ID (`false`).
  
  <Info>
  When `true`, the system automatically resolved the thread ID to the latest email in that thread.
  </Info>
</ResponseField>

## Email Threading

This endpoint automatically handles email threading by:

1. **Setting the In-Reply-To header** with the Message-ID of the original email
2. **Building the References header** to maintain the full conversation thread
3. **Formatting the subject** with "Re: " prefix if not already present
4. **Quoting the original message** (when `include_original` is true) with proper attribution

<Info>
  Email clients like Gmail, Outlook, and Apple Mail will recognize these
  threading headers and group the emails into a conversation.
</Info>

## API Versioning

The reply endpoint supports API versioning to maintain backward compatibility while introducing new features.

### Current Version (Recommended)

The current version includes:
- **Thread ID support** - Reply to threads or specific emails
- **Reply All functionality** - Include all original recipients
- **Enhanced response data** - Detailed information about what was replied to
- **Automatic thread resolution** - Seamlessly works with both email and thread IDs

To use the current version, simply omit the `API-Version` header.

### Historical Versions

Access previous API implementations by including the `API-Version` header:

<CodeGroup>
```bash Legacy Version (reply-10-01-25)
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "API-Version: reply-10-01-25" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "support@yourdomain.com",
    "text": "Your reply message"
  }'
```

```javascript Current Version (No header)
// Recommended - uses latest features
const response = await fetch('https://inbound.new/api/v2/emails/email_abc123/reply', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    from: 'support@yourdomain.com',
    text: 'Your reply message',
    replyAll: true  // New feature in current version
  })
});
```
</CodeGroup>

<Warning>
Historical versions are maintained for backward compatibility only. New integrations should use the current version to access the latest features and improvements.
</Warning>

### Version Differences

| Feature | reply-10-01-25 | Current |
|---------|----------------|---------|
| Thread ID support | ❌ Email IDs only | ✅ Email or Thread IDs |
| Reply All | ❌ Not available | ✅ Available |
| Response includes thread info | ❌ Basic response | ✅ Full thread details |
| Simplified mode | ✅ Available | ✅ Available |
| Attachments | ✅ Supported | ✅ Supported |
| Custom headers | ✅ Supported | ✅ Supported |

## Examples

### Basic Reply

Reply to an email with minimal configuration:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

const { data, error } = await inbound.reply('email_abc123', {
from: 'support@yourdomain.com',
text: 'Thank you for your email. We have received your request and will respond shortly.'
});

if (error) {
console.error('Error:', error);
} else {
console.log('Reply sent:', data.id);
}

````

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "support@yourdomain.com",
    "text": "Thank you for your email. We have received your request and will respond shortly."
  }'
````

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'support@yourdomain.com',
        'text': 'Thank you for your email. We have received your request and will respond shortly.'
    }
)

data = response.json()
```

```php PHP
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://inbound.new/api/v2/emails/email_abc123/reply');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer YOUR_API_KEY',
    'Content-Type: application/json'
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'from' => 'support@yourdomain.com',
    'text' => 'Thank you for your email. We have received your request and will respond shortly.'
]));

$response = curl_exec($ch);
$data = json_decode($response, true);
curl_close($ch);
?>
```

</RequestExample>

<ResponseExample>
```json Success
{
  "id": "sent_xyz789",
  "messageId": "xyz789@yourdomain.com",
  "awsMessageId": "0100018e1234abcd-12345678-1234-1234-1234-123456789012-000000",
  "repliedToEmailId": "email_abc123",
  "repliedToThreadId": "thread_def456",
  "isThreadReply": false
}
```
</ResponseExample>

### Advanced Reply with Custom Recipients

Reply with custom recipients, subject, HTML content, and tags:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

const { data, error } = await inbound.reply('email_abc123', {
from: 'john@yourdomain.com',
to: ['customer@example.com'],
cc: ['manager@yourdomain.com'],
subject: 'Re: Support Request #12345',
text: 'Dear Customer,\n\nWe have resolved your issue...',
html: '<p>Dear Customer,</p><p>We have resolved your issue...</p>',
headers: {
'X-Support-Ticket': '12345'
},
includeOriginal: true,
tags: [
{ name: 'category', value: 'support' },
{ name: 'priority', value: 'high' }
]
});

````

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "john@yourdomain.com",
    "from_name": "John Doe",
    "to": ["customer@example.com"],
    "cc": ["manager@yourdomain.com"],
    "subject": "Re: Support Request #12345",
    "text": "Dear Customer,\n\nWe have resolved your issue...",
    "html": "<p>Dear Customer,</p><p>We have resolved your issue...</p>",
    "headers": {
      "X-Support-Ticket": "12345"
    },
    "includeOriginal": true,
    "tags": [
      {"name": "category", "value": "support"},
      {"name": "priority", "value": "high"}
    ]
  }'
````

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'john@yourdomain.com',
        'from_name': 'John Doe',
        'to': ['customer@example.com'],
        'cc': ['manager@yourdomain.com'],
        'subject': 'Re: Support Request #12345',
        'text': 'Dear Customer,\n\nWe have resolved your issue...',
        'html': '<p>Dear Customer,</p><p>We have resolved your issue...</p>',
        'headers': {
            'X-Support-Ticket': '12345'
        },
        'includeOriginal': True,
        'tags': [
            {'name': 'category', 'value': 'support'},
            {'name': 'priority', 'value': 'high'}
        ]
    }
)

data = response.json()
```

```php PHP
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://inbound.new/api/v2/emails/email_abc123/reply');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer YOUR_API_KEY',
    'Content-Type: application/json'
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'from' => 'john@yourdomain.com',
    'from_name' => 'John Doe',
    'to' => ['customer@example.com'],
    'cc' => ['manager@yourdomain.com'],
    'subject' => 'Re: Support Request #12345',
    'text' => 'Dear Customer,\n\nWe have resolved your issue...',
    'html' => '<p>Dear Customer,</p><p>We have resolved your issue...</p>',
    'headers' => [
        'X-Support-Ticket' => '12345'
    ],
    'includeOriginal' => true,
    'tags' => [
        ['name' => 'category', 'value' => 'support'],
        ['name' => 'priority', 'value' => 'high']
    ]
]));

$response = curl_exec($ch);
$data = json_decode($response, true);
curl_close($ch);
?>
```

</RequestExample>

### Reply All to Include CC Recipients

Use Reply All to include all original recipients in your response:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

const { data, error } = await inbound.reply('email_abc123', {
  from: 'support@yourdomain.com',
  text: 'This response is going to everyone on the original email.',
  replyAll: true  // Include original sender + CC recipients
});

if (error) {
  console.error('Error:', error);
} else {
  console.log('Reply All sent:', data.id);
  console.log('Replied to email:', data.repliedToEmailId);
}
```

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "support@yourdomain.com",
    "text": "This response is going to everyone on the original email.",
    "replyAll": true
  }'
```

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'support@yourdomain.com',
        'text': 'This response is going to everyone on the original email.',
        'replyAll': True
    }
)

data = response.json()
```
</RequestExample>

<Info>
Reply All automatically:
- Includes the original sender
- Includes all CC recipients from the original email
- Excludes your own email address to prevent self-replies
- Does NOT include BCC recipients (per email standards)
</Info>

### Reply to a Thread

Reply to an entire conversation thread by using the thread ID:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

// Using a thread ID instead of an email ID
const { data, error } = await inbound.reply('thread_xyz789', {
  from: 'support@yourdomain.com',
  text: 'This reply continues the conversation thread.'
});

if (error) {
  console.error('Error:', error);
} else {
  console.log('Reply sent to thread:', data.repliedToThreadId);
  console.log('Actual email replied to:', data.repliedToEmailId);
  console.log('Was thread reply:', data.isThreadReply);  // true
}
```

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/thread_xyz789/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "support@yourdomain.com",
    "text": "This reply continues the conversation thread."
  }'
```

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/thread_xyz789/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'support@yourdomain.com',
        'text': 'This reply continues the conversation thread.'
    }
)

data = response.json()
print(f"Replied to thread: {data['repliedToThreadId']}")
print(f"Actual email: {data['repliedToEmailId']}")
print(f"Was thread reply: {data['isThreadReply']}")
```
</RequestExample>

<ResponseExample>
```json Thread Reply Success
{
  "id": "sent_xyz789",
  "messageId": "xyz789@yourdomain.com",
  "awsMessageId": "0100018e1234abcd-12345678-1234-1234-1234-123456789012-000000",
  "repliedToEmailId": "email_latest123",
  "repliedToThreadId": "thread_xyz789",
  "isThreadReply": true
}
```
</ResponseExample>

<Tip>
When you provide a thread ID, the system automatically finds the most recent email in that thread and replies to it, ensuring your response appears at the correct position in the conversation.
</Tip>

### Reply Without Quoting Original

Send a reply without including the original message:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

const { data, error } = await inbound.reply('email_abc123', {
from: 'noreply@yourdomain.com',
text: 'This is an automated response.',
includeOriginal: false
});

````

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "noreply@yourdomain.com",
    "text": "This is an automated response.",
    "include_original": false
  }'
````

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'noreply@yourdomain.com',
        'text': 'This is an automated response.',
        'include_original': False
    }
)

data = response.json()
```

```php PHP
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://inbound.new/api/v2/emails/email_abc123/reply');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer YOUR_API_KEY',
    'Content-Type: application/json'
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'from' => 'noreply@yourdomain.com',
    'text' => 'This is an automated response.',
    'include_original' => false
]));

$response = curl_exec($ch);
$data = json_decode($response, true);
curl_close($ch);
?>
```

</RequestExample>

### Reply with Attachments

Include attachments in your reply:

<RequestExample>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';
import fs from 'fs';

const inbound = new Inbound('YOUR_API_KEY');

// Read and encode file
const fileContent = fs.readFileSync('invoice.pdf');
const base64Content = fileContent.toString('base64');

const { data, error } = await inbound.reply('email_abc123', {
from: 'billing@yourdomain.com',
text: 'Please find the invoice attached.',
attachments: [{
content: base64Content,
filename: 'invoice.pdf',
content_type: 'application/pdf'
}]
});

````

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "billing@yourdomain.com",
    "text": "Please find the invoice attached.",
    "attachments": [{
      "content": "BASE64_ENCODED_CONTENT",
      "filename": "invoice.pdf",
      "content_type": "application/pdf"
    }]
  }'
````

```python Python
import requests
import base64

# Read and encode file
with open('invoice.pdf', 'rb') as f:
    file_content = f.read()
    base64_content = base64.b64encode(file_content).decode('utf-8')

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    json={
        'from': 'billing@yourdomain.com',
        'text': 'Please find the invoice attached.',
        'attachments': [{
            'content': base64_content,
            'filename': 'invoice.pdf',
            'content_type': 'application/pdf'
        }]
    }
)

data = response.json()
```

```php PHP
<?php
// Read and encode file
$fileContent = file_get_contents('invoice.pdf');
$base64Content = base64_encode($fileContent);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://inbound.new/api/v2/emails/email_abc123/reply');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer YOUR_API_KEY',
    'Content-Type: application/json'
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'from' => 'billing@yourdomain.com',
    'text' => 'Please find the invoice attached.',
    'attachments' => [[
        'content' => $base64Content,
        'filename' => 'invoice.pdf',
        'content_type' => 'application/pdf'
    ]]
]));

$response = curl_exec($ch);
$data = json_decode($response, true);
curl_close($ch);
?>
```

</RequestExample>

## Error Responses

<ResponseField name="error" type="string">
  Error message describing what went wrong
</ResponseField>

### Common Errors

| Status Code | Error Message                                                                             | Description                                                   |
| ----------- | ----------------------------------------------------------------------------------------- | ------------------------------------------------------------- |
| 400         | "Valid email ID or thread ID is required"                                                 | The ID parameter is missing or invalid                        |
| 400         | "From address is required"                                                                | The `from` field is missing from the request                  |
| 400         | "Either html or text content must be provided"                                            | No email body content was provided                            |
| 400         | "Cannot determine recipient email address"                                                | No `to` field provided and cannot extract from original email |
| 400         | "agent@inbnd.dev cannot be used for replies. Please use a verified domain email address." | Attempted to use agent email for replies                      |
| 400         | "Invalid email format: {email}"                                                           | One of the email addresses is malformed                       |
| 400         | "Invalid JSON in request body"                                                            | Request body contains malformed JSON                          |
| 400         | "Unknown API version: {version}"                                                          | Invalid API version specified in header                       |
| 401         | "Unauthorized"                                                                            | Invalid or missing API key                                    |
| 403         | "You don't have permission to send from domain: {domain}"                                 | The sender domain is not verified in your account             |
| 404         | "Email or thread not found"                                                               | The email/thread ID does not exist or belongs to another user |
| 404         | "API version '{version}' not found or unavailable"                                        | The requested API version doesn't exist                       |
| 429         | "Email sending limit reached. Please upgrade your plan to send more emails."              | You have exceeded your plan's email sending limit             |
| 500         | "Email service not configured. Please contact support."                                   | AWS SES configuration issue                                   |
| 500         | "Failed to send reply. Please try again later."                                           | AWS SES or other service error occurred                       |
| 500         | "Internal server error"                                                                   | An unexpected error occurred                                  |

<ResponseExample>
```json Domain Not Verified
{
  "error": "You don't have permission to send from domain: unverified.com"
}
```

```json Agent Email Not Allowed
{
  "error": "agent@inbnd.dev cannot be used for replies. Please use a verified domain email address."
}
```

```json Thread Not Found
{
  "error": "Email or thread not found"
}
```

```json Invalid API Version
{
  "error": "Unknown API version: invalid-version",
  "availableVersions": ["reply-10-01-25"]
}
```

</ResponseExample>

## Idempotency

This endpoint supports idempotency to prevent duplicate sends. Include an `Idempotency-Key` header with a unique value:

### Basic Idempotency Usage

<CodeGroup>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound('YOUR_API_KEY');

// Using the organized API with idempotency
const { data, error } = await inbound.email.sent.reply('email_abc123', {
from: 'support@yourdomain.com',
text: 'Thanks for your message!'
}, {
idempotencyKey: 'reply-abc123-user456-v1'
});

// Using the simplified reply method with idempotency
const { data, error } = await inbound.reply('email_abc123', {
from: 'support@yourdomain.com',
text: 'Your reply message'
}, {
idempotencyKey: 'unique-key-123'
});

````

```bash cURL
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -H "Idempotency-Key: reply-abc123-user456-v1" \
  -d '{
    "from": "support@yourdomain.com",
    "text": "Thanks for your message!"
  }'
````

```python Python
import requests

response = requests.post(
    'https://inbound.new/api/v2/emails/email_abc123/reply',
    headers={
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json',
        'Idempotency-Key': 'reply-abc123-user456-v1'
    },
    json={
        'from': 'support@yourdomain.com',
        'text': 'Thanks for your message!'
    }
)

data = response.json()
```

```php PHP
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://inbound.new/api/v2/emails/email_abc123/reply');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer YOUR_API_KEY',
    'Content-Type: application/json',
    'Idempotency-Key: reply-abc123-user456-v1'
]);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'from' => 'support@yourdomain.com',
    'text' => 'Thanks for your message!'
]));

$response = curl_exec($ch);
$data = json_decode($response, true);
curl_close($ch);
?>
```

</CodeGroup>

### Webhook Handler with Idempotency

Perfect for preventing duplicate auto-replies when webhooks are retried:

<CodeGroup>
```javascript Inbound SDK
import { Inbound } from '@inboundemail/sdk';

const inbound = new Inbound(process.env.INBOUND_API_KEY);

// Webhook handler with idempotency protection
export async function POST(request) {
try {
const { email } = await request.json();

    // Create unique key that prevents duplicates even with webhook retries
    const idempotencyKey = `auto-reply-${email.id}-${Math.floor(Date.now() / 60000)}`;

    const { data, error } = await inbound.reply(email.id, {
      from: 'support@yourdomain.com',
      text: 'Thanks for contacting us! We\'ll respond within 24 hours.',
      includeOriginal: false
    }, {
      idempotencyKey
    });

    if (error) {
      console.error('Auto-reply failed:', error);
      return Response.json({ error: 'Failed to send auto-reply' }, { status: 500 });
    }

    return Response.json({ success: true, emailId: data.id });

} catch (error) {
return Response.json({ error: 'Processing failed' }, { status: 500 });
}
}

````

```bash cURL
# First webhook call - email is sent
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Idempotency-Key: webhook-auto-reply-abc123-2024-01-15-10" \
  -d '{"from": "support@yourdomain.com", "text": "Auto-reply message"}'

# Webhook retry with same key - returns original response, no duplicate email
curl -X POST https://inbound.new/api/v2/emails/email_abc123/reply \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Idempotency-Key: webhook-auto-reply-abc123-2024-01-15-10" \
  -d '{"from": "support@yourdomain.com", "text": "Auto-reply message"}'
````

```python Python
import requests
import time

def handle_webhook(email_data):
    # Create idempotency key with minute-level precision
    # Allows updates but prevents rapid-fire duplicates
    timestamp = int(time.time() // 60)  # Minute precision
    idempotency_key = f"auto-reply-{email_data['id']}-{timestamp}"

    response = requests.post(
        f'https://inbound.new/api/v2/emails/{email_data["id"]}/reply',
        headers={
            'Authorization': 'Bearer YOUR_API_KEY',
            'Content-Type': 'application/json',
            'Idempotency-Key': idempotency_key
        },
        json={
            'from': 'support@yourdomain.com',
            'text': 'Thanks for contacting us! We will respond within 24 hours.',
            'includeOriginal': False
        }
    )

    return response.json()
```

```php PHP
<?php
function handleWebhook($emailData) {
    // Create idempotency key with minute precision
    $timestamp = floor(time() / 60);
    $idempotencyKey = "auto-reply-{$emailData['id']}-{$timestamp}";

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, "https://inbound.new/api/v2/emails/{$emailData['id']}/reply");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $_ENV['INBOUND_API_KEY'],
        'Content-Type: application/json',
        "Idempotency-Key: {$idempotencyKey}"
    ]);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
        'from' => 'support@yourdomain.com',
        'text' => 'Thanks for contacting us! We will respond within 24 hours.',
        'includeOriginal' => false
    ]));

    $response = curl_exec($ch);
    curl_close($ch);

    return json_decode($response, true);
}
?>
```

</CodeGroup>

### Idempotency Key Best Practices

<Steps>
<Step title="Make keys unique and descriptive">
  Include action type, email ID, and context: `reply-{emailId}-{userId}-v1`
</Step>

<Step title="Use for webhook handlers">
  Prevent duplicate auto-replies when webhooks are retried due to failures
</Step>

<Step title="Include version suffixes">
  Add `-v1`, `-v2` when you need to update email content for the same operation
</Step>

<Step title="Consider time windows">
  For time-sensitive operations, include timestamp to allow periodic updates
</Step>
</Steps>

<Info>
  **Idempotency Behavior**: If you make multiple requests with the same
  idempotency key, only the first request will send an email. Subsequent
  requests return the same response without sending a duplicate. Keys expire
  after **24 hours**.
</Info>

## Best Practices

<Steps>
<Step title="Verify sender domain">
  Always ensure the `from` domain is verified in your account before attempting to send replies.
</Step>

<Step title="Include both text and HTML">
  For best compatibility, include both `text` and `html` versions of your email
  content.
</Step>

<Step title="Use idempotency keys">
  When sending replies programmatically, use idempotency keys to prevent
  accidental duplicate sends.
</Step>

<Step title="Handle quoted content carefully">
  Consider whether including the original message is appropriate for your use
  case. Automated responses might not need it.
</Step>

<Step title="Test threading">
  Test your replies with various email clients to ensure threading works as expected.
</Step>
</Steps>

## Rate Limits

Reply sending is subject to the same rate limits as the [Send Email](/api-reference/emails/send-email) endpoint. Your plan determines how many emails you can send per month.

<Info>
  Check your current usage and limits in your [account
  dashboard](https://inbound.new/settings).
</Info>

1.0 - ✅
